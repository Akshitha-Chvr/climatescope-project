import pandas as pd

import numpy as np

df = pd.read_csv("c:/Users/akshi/OneDrive/Desktop/GlobalWeatherRepository.csv")
# structure
print("Shape (rows, columns):", df.shape)
# Data Types
df.dtypes
# Key Variables
location_cols = [
    "country", "location_name", "latitude", "longitude", "timezone"
]

time_cols = [
    "last_updated", "last_updated_epoch",
    "localtime", "localtime_epoch"
]

weather_cols = [
    "temperature_celsius", "temperature_fahrenheit",
    "feelslike_celsius", "feelslike_fahrenheit",
    "humidity", "uv_index", "precipitation_mm", "precipitation_in",
    "wind_mph", "wind_kph", "wind_degree", "wind_dir",
    "pressure_mb", "pressure_in",
    "visibility_km", "visibility_miles",
    "cloud", "gust_mph", "gust_kph"
]

air_quality_cols = [
    "air_quality_PM2.5", "air_quality_PM10",
    "air_quality_us-epa-index", "air_quality_gb-defra-index"
]

sun_moon_cols = [
    "sunrise", "sunset",
    "moonrise", "moonset",
    "moon_phase", "moon_illumination"
]

# PRINT THE KEY VARIABLES

print("ğŸ“ Location Variables:")
print(location_cols, "\n")

print("â±ï¸ Time Variables:")
print(time_cols, "\n")

print("ğŸŒ¡ï¸ Weather Variables:")
print(weather_cols, "\n")

print("ğŸŒ«ï¸ Air Quality Variables:")
print(air_quality_cols, "\n")

print("ğŸŒ Sun & Moon Variables:")
print(sun_moon_cols, "\n")
# Missing values
df.isna().sum()
# Anamolies
# Temperature anomalies (too low or too high)
temp_anomalies = df[
    (df["temperature_celsius"] < -80) |
    (df["temperature_celsius"] > 60)
]
print("Temperature anomalies:")
print(temp_anomalies.head())

# Humidity anomalies (should be 0â€“100)
humidity_anomalies = df[
    (df["humidity"] < 0) | 
    (df["humidity"] > 100)
]
print("\nHumidity anomalies:")
print(humidity_anomalies.head())

# Negative precipitation (impossible)
precip_anomalies = df[df["precip_mm"] < 0]
print("\nPrecipitation anomalies:")
print(precip_anomalies.head())

# Pressure anomalies (normal range: 870â€“1085 mb)
pressure_anomalies = df[
    (df["pressure_mb"] < 870) | 
    (df["pressure_mb"] > 1085)
]
print("\nPressure anomalies:")
print(pressure_anomalies.head())

#Convert units and normalize the values

num_cols = df.select_dtypes(include = 'number').columns
df_normalized = df.copy()
df_normalized[num_cols] = (df[num_cols] - df[num_cols].min()) / (df[num_cols].max() - df[num_cols].min())

df_normalized.head()




